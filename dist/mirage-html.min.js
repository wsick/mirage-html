var mirage;!function(e){var t;!function(e){e.version="0.1.0"}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(e){function t(e){function t(i){n&&(e(i,isNaN(r)?0:i-r),r=i,n&&window.requestAnimationFrame(t))}var n=!1,r=NaN;return{enable:function(){n=!0,window.requestAnimationFrame(t)},disable:function(){n=!1,r=NaN}}}e.NewAnimClock=t}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(t){function n(n){function r(){var t=i.getAttached("html.height");return"window"===t?new e.Size(window.innerWidth,window.innerHeight-20):new e.Size(a.scrollWidth,a.scrollHeight)}var i,a,o,u=t.NewDraftUpdater(n),l=new e.Size(NaN,NaN);return{getRoot:function(){return i},setRoot:function(t){e.Size.undef(l),i=t,t?(a=n.getElementByNode(i),o=e.draft.NewDrafter(i)):(a=null,o=null)},run:function(){var t=r();e.Size.isEqual(l,t)||(i.invalidateMeasure(),e.Size.copyTo(t,l)),(i.state.flags&e.core.LayoutFlags.hints)>0&&o(u,t)}}}t.NewBinder=n}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(e){function t(t,n){function r(e,t){for(var r=0;r<n.length;r++){var o=n[r],u=o.getRoot();if(u){var l=i(u);u!==l&&a(o,u,l,t);var c=e.indexOf(l);c>-1&&e.splice(r,1)}else n.splice(r,1),r--}}function i(e){for(var t=e;t.tree.parent;)t=t.tree.parent;return t}function a(e,t,n,r){if(c.indexOf(n)>-1)return void r.push(t);var i=c.indexOf(t);i>-1&&c.splice(i,1),e.setRoot(n),c.push(n)}function o(r){for(var i=0;i<r.length;i++){var a=r[i],o=e.NewBinder(t);o.setRoot(a),c.push(a),n.push(o)}}function u(e){for(var t=0;t<n.length;t++){var r=e.indexOf(n[t].getRoot());r>-1&&(l(r),t--)}}function l(e){var t=n.splice(e,1)[0],r=t.getRoot();if(t.setRoot(null),r){var i=c.indexOf(r);i>-1&&c.splice(i,1)}}var c=[];return n=n||[],{update:function(e,t){r(e,t),o(e),u(t)}}}e.NewBinderRegistry=t}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(e){function t(e){return e.nodeType===e.ELEMENT_NODE&&!!e.getAttribute("data-layout")}function n(e,n){var r=new MutationObserver(function(e){for(var r=[],i=[],a=[],o=[],u=!1,l=0;l<e.length;l++){var c=e[l];if("childList"===c.type){for(var f=0;f<c.addedNodes.length;f++){var s=c.addedNodes[f];t(s)&&(r.push(s),u=!0)}for(var f=0;f<c.removedNodes.length;f++){var s=c.removedNodes[f];t(s)&&(i.push(s),u=!0)}}else"attributes"===c.type&&(c.oldValue?t(c.target)?(o.push({target:c.target,oldValue:c.oldValue}),u=!0):(a.push(c.target),u=!0):t(c.target)&&(r.push(c.target),u=!0))}u&&n(r,i,a,o)});return{start:function(){r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["data-layout"]})},stop:function(){r.disconnect()}}}e.isMirageElement=t,e.NewDOMMonitor=n}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(e){function t(e){function t(e,t){e.style.position="absolute",e.style.left=t.x+"px",e.style.top=t.y+"px",e.style.width=t.width+"px",e.style.height=t.height+"px"}return{updateSlots:function(n){for(var r=0;r<n.length;r++){var i=n[r],a=i.node;a.tree.parent&&t(e.getElementByNode(i.node),i.newRect)}}}}e.NewDraftUpdater=t}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(t){function n(){function t(e){for(var t={},n=e.split(";"),r=0;r<n.length;r++){var i=n[r],a=i.indexOf(":");a<0||(t[i.substr(0,a).trim()]=i.substr(a+1).trim())}return t}function n(t,n){for(var r=Object.keys(n),i=0;i<r.length;i++){var a=r[i],o=e.map.getMapper(a);o&&o(t,n[a])}}return{translateNew:function(r){var i=t(r.getAttribute("data-layout")),a=i.type;if(!a)return null;var o=e.createNodeByType(a);return n(o,i),o},translateChange:function(r,i,a){var o=t(a),u=t(r.getAttribute("data-layout")),l=u.type;if(!l)return null;if(o.type!==l){var c=e.createNodeByType(l);return n(c,u),c}for(var f=Object.keys(o),s=Object.keys(u),d=0;d<f.length;d++){var g=f[d];if(!(s.indexOf(g)>-1)){var m=e.map.getMapper(g);m&&m(i,void 0)}}return n(i,u),i}}}t.NewElementTranslator=n}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(t){function n(e){e=e||document.body,u=t.NewOrchestrator(e),u.start()}function r(){return u.binders.map(function(e){return e.getRoot()})}function i(e){var t;return t="string"==typeof e?document.getElementById(e):e,t?u.tree.getNodeByElement(t):null}function a(e,t){var n="";t||(n+="\n",t="");var r=e.constructor;n+=t+r.name.toString()+"\n";for(var i=e.tree.walk();i.step();)n+=a(i.current,t+"  ");return n}function o(){e.logger=e.logging.NewConsoleLogger(function(e){var t=u.tree.getElementByNode(e),n=t&&t.id?"#"+t.id:"",r=e.constructor;return""+r.name+n})}var u;t.watch=n,t.getRoots=r,t.getLayoutNode=i,t.dumpLayoutTree=a,t.enableLogging=o}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(e){function t(t){function n(e,t){for(var n=0;n<i.length;n++)i[n].run()}var r=e.NewTreeTracker(),i=[],a=e.NewBinderRegistry(r,i),o=e.NewTreeSynchronizer(t,r,a),u=e.NewAnimClock(n);return{tree:r,binders:i,registry:a,sync:o,start:function(){o.start(!0),u.enable()},stop:function(){u.disable(),o.stop()}}}e.NewOrchestrator=t}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(e){function t(){var e=[];return{add:function(t,n,r){var i=t.getAttached("html-sync-escrow");i||(i={panel:t,entries:[]},t.setAttached("html-sync-escrow",i),e.push(i)),i.entries.push({node:r,index:Array.prototype.indexOf.call(n.parentElement.children,n)})},commit:function(){for(var t=0;t<e.length;t++){var n=e[t],r=n.panel,i=n.entries;r.setAttached("html-sync-escrow",void 0),i.sort(function(e,t){return e.index-t.index});for(var a=[],o=0;o<i.length;o++){var u=i[o];a.indexOf(u.node)>-1||(a.push(u.node),r.insertChild(u.node,u.index))}}}}}e.NewPanelInserter=t}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(t){function n(n,r,i,a){function o(e){for(var t=0;t<e.length;t++)c(e[t])}function u(e,t,n){for(var r=0;r<e.length;r++)f(e[r],!0,t,n)}function l(e,t,n){for(var r=0;r<e.length;r++)f(e[r],!1,t,n)}function c(e){if(!r.elementExists(e)&&t.isMirageElement(e)){var n=a.translateNew(e);if(n){r.add(e,n);for(var i=e.firstElementChild;i;i=i.nextElementSibling)c(i)}}}function f(t,n,i,a){var o=r.removeElement(t);if(o){if(!n)for(var u=t.firstElementChild;u;u=u.nextElementSibling)f(u,!0,null,null);var l=o.tree.parent;l||(a.push(o),s(t,i)),l instanceof e.Panel?l.removeChild(o):o.setParent(null)}}function s(e,n){for(var i=e.firstElementChild;i;i=i.nextElementSibling)t.isMirageElement(i)?n.push(r.getNodeByElement(i)):s(i,n)}function d(e,t,n){for(var i=0;i<e.length;i++){var o=e[i],u=r.getNodeByElement(o.target),l=a.translateChange(o.target,u,o.oldValue);l!==u?g(u,l,t,n):l||f(o.target,!0,t,n)}}function g(t,n,i,a){var o=r.replaceNode(t,n);if(o){var u=t.tree.parent;if(u instanceof e.Panel){var l=u.indexOfChild(t);u.removeChild(t),u.insertChild(n,l)}else u?(t.setParent(null),n.setParent(u)):(a.push(t),i.push(n));if(n instanceof e.Panel){for(var c=t.tree.walk();c.step();)n.appendChild(c.current);t instanceof e.Panel&&(t.tree.children.length=0)}}}function m(t,n,i){for(var a=0;a<t.length;a++){var o=t[a],u=r.getNodeByElement(o);if(u){var l=(o.parentElement?r.getNodeByElement(o.parentElement):null)||null;l instanceof e.Panel?i.add(l,o,u):u.setParent(l),u.tree.parent||n.push(u),v(o,u,i)}}}function v(t,n,i){for(var a=t.firstElementChild,o=0;a;a=a.nextElementSibling,o++){var u=r.getNodeByElement(a);u&&!u.tree.parent&&(n instanceof e.Panel?i.add(n,a,u):u.setParent(n),v(a,u,i))}}function h(e,n,r,a){var c=t.NewPanelInserter(),f=[],s=[];o(e),u(r,f,s),l(n,f,s),d(a,f,s),m(e,f,c),c.commit(),i.update(f,s)}function p(){var e=[];N(n,e,!1),h(e,[],[],[])}function N(e,n,r){var i=t.isMirageElement(e);i&&!r&&n.push(e);for(var a=e.firstElementChild;a;a=a.nextElementSibling)N(a,n,i)}r=r||t.NewTreeTracker(),i=i||t.NewBinderRegistry(r),a=a||t.NewElementTranslator();var y=t.NewDOMMonitor(n,h);return{start:function(e){e&&p(),y.start()},stop:function(){y.stop()}}}t.NewTreeSynchronizer=n}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(e){function t(){var e={},t={},n=0;return{add:function(i,a){n++;var o=n.toString();return i.setAttributeNS(r,"uid",o),a.setAttached("mirage-uid",o),e[o]=i,t[o]=a,o},replaceNode:function(e,n){var r=e.getAttached("mirage-uid");return t[r]===e?(e.setAttached("mirage-uid",void 0),n.setAttached("mirage-uid",r),t[r]=n,r):""},removeElement:function(n){var i=n.getAttributeNS(r,"uid"),a=i?t[i]:null;return n.removeAttributeNS(r,"uid"),a&&(a.setAttached("mirage-uid",void 0),delete e[i],delete t[i]),a},elementExists:function(t){var n=t.getAttributeNS(r,"uid");return e[n]===t},getNodeByElement:function(e){var n=e.getAttributeNS(r,"uid");return t[n]},getElementByNode:function(t){var n=t.getAttached("mirage-uid");return e[n]}}}function n(e){return e.getAttached("mirage-uid")}var r="http://schemas.wsick.com/mirage/html";e.NewTreeTracker=t,e.getNodeUid=n}(t=e.html||(e.html={}))}(mirage||(mirage={}));
//# sourceMappingURL=mirage-html.min.js.map
