var mirage;!function(e){var t;!function(e){e.version="0.1.0"}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(e){function t(e){function t(i){n&&(e(i,isNaN(r)?0:i-r),r=i,n&&window.requestAnimationFrame(t))}var n=!1,r=NaN;return{enable:function(){n=!0,window.requestAnimationFrame(t)},disable:function(){n=!1,r=NaN}}}e.NewAnimClock=t}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(t){function n(t){function n(t){return new e.Size(t.scrollWidth,t.scrollHeight)}var r,i,a,o=new e.Size(NaN,NaN),u={updateSlots:function(e){for(var n=0;n<e.length;n++){var r=e[n];t.getElementByNode(r.node)}}};return{getRoot:function(){return r},setRoot:function(n){e.Size.undef(o),r=n,n?(i=t.getElementByNode(r),a=e.draft.NewDrafter(r)):(i=null,a=null)},run:function(){var t=n(i);e.Size.isEqual(o,t)||(a(u,t),e.Size.copyTo(t,o))}}}t.NewBinder=n}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(e){function t(t,n){function r(e){var t=e.getRoot();if(!t)return null;for(var n=t;n.tree.parent;)n=n.tree.parent;return n===t?null:u.indexOf(n)>-1?null:n}function i(e){for(var t=e.slice(0),i=0;i<n.length;i++){var a=n[i],o=r(a);if(o){a.setRoot(o),u.push(o);var l=t.indexOf(o);l>-1&&t.splice(l,1)}else n.splice(i,1),i--}return t}function a(r){for(var i=0;i<r.length;i++){var a=r[i],o=e.NewBinder(t);o.setRoot(a),u.push(a),n.push(o)}}function o(e){for(var t=0;t<n.length;t++){var r=n[t],i=r.getRoot(),a=e.indexOf(i);if(a>-1){n.splice(a,1),t--,r.setRoot(null);var o=u.indexOf(i);o>-1&&u.splice(o,1)}}}var u=[];return n=n||[],{update:function(e,t){var n=i(e);a(n),o(t)}}}e.NewBinderRegistry=t}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(e){function t(e){return e.nodeType===e.ELEMENT_NODE&&!!e.getAttribute("data-layout")}function n(e,n){var r=new MutationObserver(function(e){for(var r=[],i=[],a=[],o=0;o<e.length;o++){var u=e[o];if("childList"===u.type){for(var l=0;l<u.addedNodes.length;l++){var c=u.addedNodes[l];t(c)&&r.push(c)}for(var l=0;l<u.removedNodes.length;l++){var c=u.removedNodes[l];t(c)&&i.push(c)}}else"attributes"===u.type&&(u.oldValue?t(u.target)||a.push(u.target):t(u.target)&&r.push(u.target))}(r.length>0||i.length>0||a.length>0)&&n(r,i,a)});return{start:function(){r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["data-layout"]})},stop:function(){r.disconnect()}}}e.isMirageElement=t,e.NewDOMMonitor=n}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){function t(t){t=t||document.body,a=e.html.NewOrchestrator(t),a.start()}function n(){return a.binders.map(function(e){return e.getRoot()})}function r(e){var t;return t="string"==typeof e?document.getElementById(e):e,t?a.tree.getNodeByElement(t):null}function i(e,t){var n="";t||(n+="\n",t="");var r=e.constructor;n+=t+r.name.toString()+"\n";for(var a=e.tree.walk();a.step();)n+=i(a.current,t+"  ");return n}var a;e.watchDOM=t,e.getRoots=n,e.getLayoutNode=r,e.dumpLayoutTree=i}(mirage||(mirage={}));var mirage;!function(e){var t;!function(e){function t(t){function n(e,t){for(var n=0;n<i.length;n++)i[n].run()}var r=e.NewTreeTracker(),i=[],a=e.NewBinderRegistry(r,i),o=e.NewTreeSynchronizer(t,r,a),u=e.NewAnimClock(n);return{tree:r,binders:i,registry:a,sync:o,start:function(){o.start(!0),u.enable()},stop:function(){u.disable(),o.stop()}}}e.NewOrchestrator=t}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(e){function t(){var e=[];return{add:function(t,n,r){var i=t.getAttached("html-sync-escrow");i||(i={panel:t,entries:[]},t.setAttached("html-sync-escrow",i),e.push(i)),i.entries.push({node:r,index:Array.prototype.indexOf.call(n.parentElement.children,n)})},commit:function(){for(var t=0;t<e.length;t++){var n=e[t],r=n.panel,i=n.entries;r.setAttached("html-sync-escrow",void 0),i.sort(function(e,t){return e.index-t.index});for(var a=[],o=0;o<i.length;o++){var u=i[o];a.indexOf(u.node)>-1||(a.push(u.node),r.insertChild(u.node,u.index))}}}}}e.NewPanelInserter=t}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(t){function n(n,r,i){function a(e){for(var t=0;t<e.length;t++)l(e[t])}function o(e,t,n){for(var r=0;r<e.length;r++)c(e[r],!0,t,n)}function u(e,t,n){for(var r=0;r<e.length;r++)c(e[r],!1,t,n)}function l(n){if(!r.elementExists(n)&&t.isMirageElement(n)){var i=e.createNodeByType("panel");r.add(n,i);for(var a=n.firstElementChild;a;a=a.nextElementSibling)l(a)}}function c(t,n,i,a){var o=r.removeElement(t);if(o){if(!n)for(var u=t.firstElementChild;u;u=u.nextElementSibling)c(u,!0,null,null);var l=o.tree.parent;l||(a.push(o),f(t,i)),l instanceof e.Panel?l.removeChild(o):o.setParent(null)}}function f(e,n){for(var i=e.firstElementChild;i;i=i.nextElementSibling)t.isMirageElement(i)?n.push(r.getNodeByElement(i)):f(i,n)}function m(t,n,i){for(var a=0;a<t.length;a++){var o=t[a],u=r.getNodeByElement(o);if(u){var l=(o.parentElement?r.getNodeByElement(o.parentElement):null)||null;l instanceof e.Panel?i.add(l,o,u):u.setParent(l),u.tree.parent||n.push(u),s(o,u,i)}}}function s(t,n,i){for(var a=t.firstElementChild,o=0;a;a=a.nextElementSibling,o++){var u=r.getNodeByElement(a);u&&!u.tree.parent&&(n instanceof e.Panel?i.add(n,a,u):u.setParent(n),s(a,u,i))}}function d(e,n,r){var l=t.NewPanelInserter(),c=[],f=[];a(e),o(r,c,f),u(n,c,f),m(e,c,l),l.commit(),i.update(c,f)}function g(){var e=[];v(n,e,!1),d(e,[],[])}function v(e,n,r){var i=t.isMirageElement(e);i&&!r&&n.push(e);for(var a=e.firstElementChild;a;a=a.nextElementSibling)v(a,n,i)}r=r||t.NewTreeTracker(),i=i||t.NewBinderRegistry(r);var h=t.NewDOMMonitor(n,d);return{start:function(e){e&&g(),h.start()},stop:function(){h.stop()}}}t.NewTreeSynchronizer=n}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(e){function t(){var e={},t={},n=0;return{add:function(i,a){n++;var o=n.toString();return i.setAttributeNS(r,"uid",o),a.setAttached("mirage-uid",o),e[o]=i,t[o]=a,o},removeElement:function(n){var i=n.getAttributeNS(r,"uid"),a=i?t[i]:null;return n.removeAttributeNS(r,"uid"),a&&(a.setAttached("mirage-uid",void 0),delete e[i],delete t[i]),a},elementExists:function(t){var n=t.getAttributeNS(r,"uid");return e[n]===t},getNodeByElement:function(e){var n=e.getAttributeNS(r,"uid");return t[n]},getElementByNode:function(t){var n=t.getAttached("mirage-uid");return e[n]}}}function n(e){return e.getAttached("mirage-uid")}var r="http://schemas.wsick.com/mirage/html";e.NewTreeTracker=t,e.getNodeUid=n}(t=e.html||(e.html={}))}(mirage||(mirage={}));
//# sourceMappingURL=mirage-html.min.js.map
