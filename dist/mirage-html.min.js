var mirage;!function(e){var t;!function(e){e.version="0.1.0"}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(e){function t(e){function t(a){n&&(e(a,isNaN(r)?0:a-r),r=a,n&&window.requestAnimationFrame(t))}var n=!1,r=NaN;return{enable:function(){n=!0,window.requestAnimationFrame(t)},disable:function(){n=!1,r=NaN}}}e.NewAnimClock=t}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(t){function n(t){function n(t){return new e.Size(t.scrollWidth,t.scrollHeight)}var r,a,i,o=new e.Size(NaN,NaN),u={updateSlots:function(e){for(var n=0;n<e.length;n++){var r=e[n];t.getElementByNode(r.node)}}};return{getRoot:function(){return r},setRoot:function(n){e.Size.undef(o),r=n,n?(a=t.getElementByNode(r),i=e.draft.NewDrafter(r)):(a=null,i=null)},run:function(){var t=n(a);e.Size.isEqual(o,t)||(i(u,t),e.Size.copyTo(t,o))}}}t.NewBinder=n}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(e){function t(t,n){function r(e){var t=e.getRoot();if(!t)return null;for(var n=t;n.tree.parent;)n=n.tree.parent;return n===t?null:u.indexOf(n)>-1?null:n}function a(e){for(var t=e.slice(0),a=0;a<n.length;a++){var i=n[a],o=r(i);if(o){i.setRoot(o),u.push(o);var l=t.indexOf(o);l>-1&&t.splice(l,1)}else n.splice(a,1),a--}return t}function i(r){for(var a=0;a<r.length;a++){var i=r[a],o=e.NewBinder(t);o.setRoot(i),u.push(i),n.push(o)}}function o(e){for(var t=0;t<n.length;t++){var r=n[t],a=r.getRoot(),i=e.indexOf(a);if(i>-1){n.splice(i,1),t--,r.setRoot(null);var o=u.indexOf(a);o>-1&&u.splice(o,1)}}}var u=[];return n=n||[],{update:function(e,t){var n=a(e);i(n),o(t)}}}e.NewBinderRegistry=t}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(e){function t(e){return e.nodeType===e.ELEMENT_NODE&&!!e.getAttribute("data-layout")}function n(e,n){var r=new MutationObserver(function(e){for(var r=[],a=[],i=[],o=[],u=!1,l=0;l<e.length;l++){var c=e[l];if("childList"===c.type){for(var f=0;f<c.addedNodes.length;f++){var s=c.addedNodes[f];t(s)&&(r.push(s),u=!0)}for(var f=0;f<c.removedNodes.length;f++){var s=c.removedNodes[f];t(s)&&(a.push(s),u=!0)}}else"attributes"===c.type&&(c.oldValue?t(c.target)?(o.push({target:c.target,oldValue:c.oldValue}),u=!0):(i.push(c.target),u=!0):t(c.target)&&(r.push(c.target),u=!0))}u&&n(r,a,i,o)});return{start:function(){r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["data-layout"]})},stop:function(){r.disconnect()}}}e.isMirageElement=t,e.NewDOMMonitor=n}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(t){function n(){function t(e){for(var t={},n=e.split(";"),r=0;r<n.length;r++){var a=n[r],i=a.indexOf(":");i<0||(t[a.substr(0,i).trim()]=a.substr(i+1).trim())}return t}function n(t,n){for(var r=Object.keys(n),a=0;a<r.length;a++){var i=r[a],o=e.map.getMapper(i);o&&o(t,n[i])}}return{translateNew:function(r){var a=t(r.getAttribute("data-layout")),i=a.type;if(!i)return null;var o=e.createNodeByType(i);return n(o,a),o},translateChange:function(r,a,i){var o=t(i),u=t(r.getAttribute("data-layout")),l=u.type;if(!l)return null;if(o.type!==l){var c=e.createNodeByType(l);return n(c,u),c}for(var f=Object.keys(o),s=Object.keys(u),d=0;d<f.length;d++){var m=f[d];if(!(s.indexOf(m)>-1)){var g=e.map.getMapper(m);g&&g(a,void 0)}}return n(a,u),a}}}t.NewElementTranslator=n}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){function t(t){t=t||document.body,i=e.html.NewOrchestrator(t),i.start()}function n(){return i.binders.map(function(e){return e.getRoot()})}function r(e){var t;return t="string"==typeof e?document.getElementById(e):e,t?i.tree.getNodeByElement(t):null}function a(e,t){var n="";t||(n+="\n",t="");var r=e.constructor;n+=t+r.name.toString()+"\n";for(var i=e.tree.walk();i.step();)n+=a(i.current,t+"  ");return n}var i;e.watchDOM=t,e.getRoots=n,e.getLayoutNode=r,e.dumpLayoutTree=a}(mirage||(mirage={}));var mirage;!function(e){var t;!function(e){function t(t){function n(e,t){for(var n=0;n<a.length;n++)a[n].run()}var r=e.NewTreeTracker(),a=[],i=e.NewBinderRegistry(r,a),o=e.NewTreeSynchronizer(t,r,i),u=e.NewAnimClock(n);return{tree:r,binders:a,registry:i,sync:o,start:function(){o.start(!0),u.enable()},stop:function(){u.disable(),o.stop()}}}e.NewOrchestrator=t}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(e){function t(){var e=[];return{add:function(t,n,r){var a=t.getAttached("html-sync-escrow");a||(a={panel:t,entries:[]},t.setAttached("html-sync-escrow",a),e.push(a)),a.entries.push({node:r,index:Array.prototype.indexOf.call(n.parentElement.children,n)})},commit:function(){for(var t=0;t<e.length;t++){var n=e[t],r=n.panel,a=n.entries;r.setAttached("html-sync-escrow",void 0),a.sort(function(e,t){return e.index-t.index});for(var i=[],o=0;o<a.length;o++){var u=a[o];i.indexOf(u.node)>-1||(i.push(u.node),r.insertChild(u.node,u.index))}}}}}e.NewPanelInserter=t}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(t){function n(n,r,a,i){function o(e){for(var t=0;t<e.length;t++)c(e[t])}function u(e,t,n){for(var r=0;r<e.length;r++)f(e[r],!0,t,n)}function l(e,t,n){for(var r=0;r<e.length;r++)f(e[r],!1,t,n)}function c(e){if(!r.elementExists(e)&&t.isMirageElement(e)){var n=i.translateNew(e);if(n){r.add(e,n);for(var a=e.firstElementChild;a;a=a.nextElementSibling)c(a)}}}function f(t,n,a,i){var o=r.removeElement(t);if(o){if(!n)for(var u=t.firstElementChild;u;u=u.nextElementSibling)f(u,!0,null,null);var l=o.tree.parent;l||(i.push(o),s(t,a)),l instanceof e.Panel?l.removeChild(o):o.setParent(null)}}function s(e,n){for(var a=e.firstElementChild;a;a=a.nextElementSibling)t.isMirageElement(a)?n.push(r.getNodeByElement(a)):s(a,n)}function d(e,t,n){for(var a=0;a<e.length;a++){var o=e[a],u=r.getNodeByElement(o.target),l=i.translateChange(o.target,u,o.oldValue);l!==u?m(u,l,t,n):l||f(o.target,!0,t,n)}}function m(t,n,a,i){var o=r.replaceNode(t,n);if(o){var u=t.tree.parent;if(u instanceof e.Panel){var l=u.indexOfChild(t);u.removeChild(t),u.insertChild(n,l)}else u?(t.setParent(null),n.setParent(u)):(i.push(t),a.push(n));if(n instanceof e.Panel){for(var c=t.tree.walk();c.step();)n.appendChild(c.current);t instanceof e.Panel&&(t.tree.children.length=0)}}}function g(t,n,a){for(var i=0;i<t.length;i++){var o=t[i],u=r.getNodeByElement(o);if(u){var l=(o.parentElement?r.getNodeByElement(o.parentElement):null)||null;l instanceof e.Panel?a.add(l,o,u):u.setParent(l),u.tree.parent||n.push(u),v(o,u,a)}}}function v(t,n,a){for(var i=t.firstElementChild,o=0;i;i=i.nextElementSibling,o++){var u=r.getNodeByElement(i);u&&!u.tree.parent&&(n instanceof e.Panel?a.add(n,i,u):u.setParent(n),v(i,u,a))}}function h(e,n,r,i){var c=t.NewPanelInserter(),f=[],s=[];o(e),u(r,f,s),l(n,f,s),d(i,f,s),g(e,f,c),c.commit(),a.update(f,s)}function p(){var e=[];N(n,e,!1),h(e,[],[],[])}function N(e,n,r){var a=t.isMirageElement(e);a&&!r&&n.push(e);for(var i=e.firstElementChild;i;i=i.nextElementSibling)N(i,n,a)}r=r||t.NewTreeTracker(),a=a||t.NewBinderRegistry(r),i=i||t.NewElementTranslator();var y=t.NewDOMMonitor(n,h);return{start:function(e){e&&p(),y.start()},stop:function(){y.stop()}}}t.NewTreeSynchronizer=n}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(e){function t(){var e={},t={},n=0;return{add:function(a,i){n++;var o=n.toString();return a.setAttributeNS(r,"uid",o),i.setAttached("mirage-uid",o),e[o]=a,t[o]=i,o},replaceNode:function(e,n){var r=e.getAttached("mirage-uid");return t[r]===e?(e.setAttached("mirage-uid",void 0),n.setAttached("mirage-uid",r),t[r]=n,r):""},removeElement:function(n){var a=n.getAttributeNS(r,"uid"),i=a?t[a]:null;return n.removeAttributeNS(r,"uid"),i&&(i.setAttached("mirage-uid",void 0),delete e[a],delete t[a]),i},elementExists:function(t){var n=t.getAttributeNS(r,"uid");return e[n]===t},getNodeByElement:function(e){var n=e.getAttributeNS(r,"uid");return t[n]},getElementByNode:function(t){var n=t.getAttached("mirage-uid");return e[n]}}}function n(e){return e.getAttached("mirage-uid")}var r="http://schemas.wsick.com/mirage/html";e.NewTreeTracker=t,e.getNodeUid=n}(t=e.html||(e.html={}))}(mirage||(mirage={}));
//# sourceMappingURL=mirage-html.min.js.map
