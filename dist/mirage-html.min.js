var mirage;!function(e){var t;!function(e){e.version="0.1.0"}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(e){function t(e){function t(i){n&&(e(i,isNaN(r)?0:i-r),r=i,n&&window.requestAnimationFrame(t))}var n=!1,r=NaN;return{enable:function(){n=!0,window.requestAnimationFrame(t)},disable:function(){n=!1,r=NaN}}}e.NewAnimClock=t}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(t){function n(n){function r(){var t=i.getAttached("html.height");return"window"===t?new e.Size(window.innerWidth,window.innerHeight-20):new e.Size(a.scrollWidth,a.scrollHeight)}var i,a,o,l=t.NewDraftUpdater(n),u=new e.Size(NaN,NaN);return{getRoot:function(){return i},setRoot:function(t){e.Size.undef(u),i=t,t?(a=n.getElementByNode(i),o=e.draft.NewDrafter(i)):(a=null,o=null)},run:function(){var t=r();e.Size.isEqual(u,t)||(i.invalidateMeasure(),e.Size.copyTo(t,u)),(i.state.flags&e.core.LayoutFlags.hints)>0&&o(l,t)}}}t.NewBinder=n}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(e){function t(t,n){function r(e,t){for(var r=0;r<n.length;r++){var o=n[r],l=o.getRoot();if(l){var u=i(l);l!==u&&a(o,l,u,t);var s=e.indexOf(u);s>-1&&e.splice(r,1)}else n.splice(r,1),r--}}function i(e){for(var t=e;t.tree.parent;)t=t.tree.parent;return t}function a(e,t,n,r){if(s.indexOf(n)>-1)return void r.push(t);var i=s.indexOf(t);i>-1&&s.splice(i,1),e.setRoot(n),s.push(n)}function o(r){for(var i=0;i<r.length;i++){var a=r[i],o=e.NewBinder(t);o.setRoot(a),s.push(a),n.push(o)}}function l(e){for(var t=0;t<n.length;t++){var r=e.indexOf(n[t].getRoot());r>-1&&(u(t),t--)}}function u(e){var t=n.splice(e,1)[0],r=t.getRoot();if(t.setRoot(null),r){var i=s.indexOf(r);i>-1&&s.splice(i,1)}}var s=[];return n=n||[],{update:function(e,t){r(e,t),o(e),l(t)}}}e.NewBinderRegistry=t}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(e){function t(e){return e.nodeType===e.ELEMENT_NODE&&!!e.getAttribute("data-layout")}function n(n,r){var i=new MutationObserver(function(n){for(var i=[],a=[],o=[],l=[],u=!1,s=0;s<n.length;s++){var c=n[s];if(!e.HtmlNode.isDummyElement(c.target))if("childList"===c.type){for(var d=0;d<c.addedNodes.length;d++){var f=c.addedNodes[d];t(f)&&(i.push(f),u=!0)}for(var d=0;d<c.removedNodes.length;d++){var f=c.removedNodes[d];t(f)&&(a.push(f),u=!0)}}else"attributes"===c.type&&(c.oldValue?t(c.target)?(l.push({target:c.target,oldValue:c.oldValue}),u=!0):(o.push(c.target),u=!0):t(c.target)&&(i.push(c.target),u=!0))}u&&r(i,a,o,l)});return{start:function(){i.observe(n,{childList:!0,subtree:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["data-layout"]})},stop:function(){i.disconnect()}}}e.isMirageElement=t,e.NewDOMMonitor=n}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(e){function t(e){function t(e,t){e.style.position="absolute",e.style.left=t.x+"px",e.style.top=t.y+"px",e.style.width=t.width+"px",e.style.height=t.height+"px",e.style.boxSizing="border-box"}return{updateSlots:function(n){for(var r=0;r<n.length;r++){var i=n[r],a=i.node,o=e.getElementByNode(i.node);o.style.display="none",a.tree.parent&&t(e.getElementByNode(i.node),i.newRect),o.style.display=""}}}}e.NewDraftUpdater=t}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(t){function n(){function n(e){for(var t={},n=e.split(";"),r=0;r<n.length;r++){var i=n[r],a=i.indexOf(":");a<0||(t[i.substr(0,a).trim()]=i.substr(a+1).trim())}return t}function r(t,n){for(var r=Object.keys(n),i=0;i<r.length;i++){var a=r[i],o=e.map.getMapper(a);o&&o(t,n[a])}}return{translateNew:function(i){var a=n(i.getAttribute("data-layout")),o=a.type;if(!o)return null;i.style.display="none";var l=e.createNodeByType(o);return"html"===o&&t.HtmlNode.setElement(l,i),r(l,a),l},translateChange:function(t,i,a){var o=n(a),l=n(t.getAttribute("data-layout")),u=l.type;if(!u)return null;if(o.type!==u){var s=e.createNodeByType(u);return r(s,l),s}for(var c=Object.keys(o),d=Object.keys(l),f=0;f<c.length;f++){var m=c[f];if(!(d.indexOf(m)>-1)){var g=e.map.getMapper(m);g&&g(i,void 0)}}return r(i,l),i}}}t.NewElementTranslator=n}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(t){function n(e){e=e||document.body,l=t.NewOrchestrator(e),l.start()}function r(){return l.binders.map(function(e){return e.getRoot()})}function i(e){var t;return t="string"==typeof e?document.getElementById(e):e,t?l.tree.getNodeByElement(t):null}function a(e,t){var n="";t||(n+="\n",t="");var r=e.constructor;n+=t+r.name.toString()+"\n";for(var i=e.tree.walk();i.step();)n+=a(i.current,t+"  ");return n}function o(){e.logger=e.logging.NewConsoleLogger(function(e){var t=l.tree.getElementByNode(e),n=t&&t.id?"#"+t.id:"",r=e.constructor;return""+r.name+n})}var l;t.watch=n,t.getRoots=r,t.getLayoutNode=i,t.dumpLayoutTree=a,t.enableLogging=o}(t=e.html||(e.html={}))}(mirage||(mirage={}));var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},mirage;!function(e){var t;!function(t){function n(t,n){r||(r=document.createElement("div"),r.id="mirage-dummy",r.style.position="absolute",r.style.boxSizing="border-box",r.style.display="none",document.body.appendChild(r)),r.style.width=isFinite(n.width)?n.width+"px":"",r.style.height=isFinite(n.height)?n.height+"px":"",r.style.display="",r.innerHTML=t.outerHTML;var i=r.firstElementChild;i.style.display="";var a=i.getBoundingClientRect();return r.innerHTML="",r.style.display="none",new e.Size(a.width,a.height)}var r,i=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),i.getElement=function(e){return e.getAttached("html-element")},i.setElement=function(e,t){e.setAttached("html-element",t),e.invalidateMeasure()},i.prototype.measureOverride=function(t){var r=i.getElement(this);return r?n(r,t):new e.Size},i.prototype.arrangeOverride=function(e){return e},i.isDummyElement=function(e){return e===r},i}(e.core.LayoutNode);t.HtmlNode=i,e.registerNodeType("html",i)}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(e){function t(t){function n(e,t){for(var n=0;n<i.length;n++)i[n].run()}var r=e.NewTreeTracker(),i=[],a=e.NewBinderRegistry(r,i),o=e.NewTreeSynchronizer(t,r,a),l=e.NewAnimClock(n);return{tree:r,binders:i,registry:a,sync:o,start:function(){o.start(!0),l.enable()},stop:function(){l.disable(),o.stop()}}}e.NewOrchestrator=t}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(e){function t(){var e=[];return{add:function(t,n,r){var i=t.getAttached("html-sync-escrow");i||(i={panel:t,entries:[]},t.setAttached("html-sync-escrow",i),e.push(i)),i.entries.push({node:r,index:Array.prototype.indexOf.call(n.parentElement.children,n)})},commit:function(){for(var t=0;t<e.length;t++){var n=e[t],r=n.panel,i=n.entries;r.setAttached("html-sync-escrow",void 0),i.sort(function(e,t){return e.index-t.index});for(var a=[],o=0;o<i.length;o++){var l=i[o];a.indexOf(l.node)>-1||(a.push(l.node),r.insertChild(l.node,l.index))}}}}}e.NewPanelInserter=t}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(t){function n(n,r,i,a){function o(e){for(var t=0;t<e.length;t++)s(e[t])}function l(e,t,n){for(var r=0;r<e.length;r++)c(e[r],!0,t,n)}function u(e,t,n){for(var r=0;r<e.length;r++)c(e[r],!1,t,n)}function s(e){if(!r.elementExists(e)&&t.isMirageElement(e)){var n=a.translateNew(e);if(n){r.add(e,n);for(var i=e.firstElementChild;i;i=i.nextElementSibling)s(i)}}}function c(t,n,i,a){var o=r.removeElement(t);if(o){if(n)for(var l=o.tree.walk();l.step();)l.current.setParent(null);else for(var u=t.firstElementChild;u;u=u.nextElementSibling)c(u,!0,null,null);var s=o.tree.parent;s||(a.push(o),d(t,i)),s instanceof e.Panel?s.removeChild(o):o.setParent(null)}}function d(e,n){for(var i=e.firstElementChild;i;i=i.nextElementSibling)t.isMirageElement(i)?n.push(r.getNodeByElement(i)):d(i,n)}function f(e,t,n){for(var i=0;i<e.length;i++){var o=e[i],l=r.getNodeByElement(o.target),u=a.translateChange(o.target,l,o.oldValue);u!==l?m(l,u,t,n):u||c(o.target,!0,t,n)}}function m(t,n,i,a){var o=r.replaceNode(t,n);if(o){var l=t.tree.parent;if(l instanceof e.Panel){var u=l.indexOfChild(t);l.removeChild(t),l.insertChild(n,u)}else l?(t.setParent(null),n.setParent(l)):(a.push(t),i.push(n));if(n instanceof e.Panel){for(var s=t.tree.walk();s.step();)n.appendChild(s.current);t instanceof e.Panel&&(t.tree.children.length=0)}}}function g(t,n,i){for(var a=0;a<t.length;a++){var o=t[a],l=r.getNodeByElement(o);if(l){var u=(o.parentElement?r.getNodeByElement(o.parentElement):null)||null;u instanceof e.Panel?i.add(u,o,l):l.setParent(u),l.tree.parent||n.push(l),h(o,l,i)}}}function h(t,n,i){for(var a=t.firstElementChild,o=0;a;a=a.nextElementSibling,o++){var l=r.getNodeByElement(a);l&&!l.tree.parent&&(n instanceof e.Panel?i.add(n,a,l):l.setParent(n),h(a,l,i))}}function v(e,n,r,a){var s=t.NewPanelInserter(),c=[],d=[];o(e),l(r,c,d),u(n,c,d),f(a,c,d),g(e,c,s),s.commit(),i.update(c,d)}function p(){var e=[];y(n,e,!1),v(e,[],[],[])}function y(e,n,r){var i=t.isMirageElement(e);i&&!r&&n.push(e);for(var a=e.firstElementChild;a;a=a.nextElementSibling)y(a,n,i)}r=r||t.NewTreeTracker(),i=i||t.NewBinderRegistry(r),a=a||t.NewElementTranslator();var N=t.NewDOMMonitor(n,v);return{start:function(e){e&&p(),N.start()},stop:function(){N.stop()}}}t.NewTreeSynchronizer=n}(t=e.html||(e.html={}))}(mirage||(mirage={}));var mirage;!function(e){var t;!function(e){function t(){var e={},t={},n=0;return{add:function(i,a){n++;var o=n.toString();return i.setAttributeNS(r,"uid",o),a.setAttached("mirage-uid",o),e[o]=i,t[o]=a,o},replaceNode:function(e,n){var r=e.getAttached("mirage-uid");return t[r]===e?(e.setAttached("mirage-uid",void 0),n.setAttached("mirage-uid",r),t[r]=n,r):""},removeElement:function(n){var i=n.getAttributeNS(r,"uid"),a=i?t[i]:null;return n.removeAttributeNS(r,"uid"),a&&(a.setAttached("mirage-uid",void 0),delete e[i],delete t[i]),a},elementExists:function(t){var n=t.getAttributeNS(r,"uid");return e[n]===t},getNodeByElement:function(e){var n=e.getAttributeNS(r,"uid");return t[n]},getElementByNode:function(t){var n=t.getAttached("mirage-uid");return e[n]}}}function n(e){return e.getAttached("mirage-uid")}var r="http://schemas.wsick.com/mirage/html";e.NewTreeTracker=t,e.getNodeUid=n}(t=e.html||(e.html={}))}(mirage||(mirage={}));
//# sourceMappingURL=mirage-html.min.js.map
